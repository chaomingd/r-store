(self.webpackChunkr_model_store=self.webpackChunkr_model_store||[]).push([[900],{66042:function(H,C,a){"use strict";a.d(C,{H:function(){return z},t:function(){return W}});var p=a(31759),A=a.n(p),b=a(26068),M=a.n(b),y=a(25298),S=a.n(y),I=a(17069),L=a.n(I),B=a(82092),d=a.n(B),D=a(75271),$=a(54484),G=a(62657),F=a.n(G),J=a(21742),X=a.n(J),Q=a(83136),Z=a.n(Q),P=a(80189),Y=300,N=function(O){X()(u,O);var h=Z()(u);function u(f){var s;return S()(this,u),s=h.call(this),d()(F()(s),"execId",0),d()(F()(s),"options",{}),d()(F()(s),"abortSignalMap",{}),f&&(s.options=f),s}return L()(u,[{key:"getCurrentExecId",value:function(){return this.execId}},{key:"getAbortController",value:function(s){return this.abortSignalMap[s]}},{key:"exec",value:function(s){var o=this,v=0,g=++this.execId;return this.emit("loading"),new Promise(function(E,m){var U=function R(){var V=o.abortSignalMap[g-1]||null,T=o.abortSignalMap[g]=new AbortController;s({lastAbortController:V,abortController:T},v).then(function(t){return g===o.execId&&o.emit("success",t),E(t),delete o.abortSignalMap[g],o.emit("finish",null,t),t}).catch(function(t){g===o.execId?v<(o.options.retryCount||0)?setTimeout(function(){R()},o.options.retryInterval||Y):(o.emit("error",t),m(t),delete o.abortSignalMap[g],o.emit("finish",t,null)):(delete o.abortSignalMap[g],o.emit("finish",t,null),m(t)),v++})};U()})}}]),u}(P.EventEmitter2),K=a(15361),w=$.useSyncExternalStoreWithSelector,z=function(){function O(h){var u=this;S()(this,O),d()(this,"isUnMount",!1),d()(this,"name",void 0),d()(this,"state",{}),d()(this,"_effects",{}),d()(this,"_preState",{}),d()(this,"_dispatchSignal",""),d()(this,"_subscribes",[]),d()(this,"asyncManagerMap",{}),d()(this,"_isInited",!1),d()(this,"getState",function(){return u._isInited||u.init(),u.state}),d()(this,"useSelector",function(f){var s=(0,D.useCallback)(function(E){return u.subscribe(function(m,U){U||E()})},[u]),o=(0,K.useMemoizedFn)(function(E){return E}),v=(0,K.useMemoizedFn)(function(E,m){return f?f(E,m):Object.is(E,m)}),g=w(s,u.getState,u.getState,o,v);return g}),d()(this,"useGetState",function(f,s){return u.useSelector(function(o,v){return s?s(o,v):!!(f&&(0,P.shallowEqualKeys)(o,v,f))})}),this.config=h}return L()(O,[{key:"init",value:function(){if(!this._isInited){this._isInited=!0;var u=this.config;this.state=this.getActualState({},u.state||{}),this._preState=M()({},this.state),u.effects&&this.setEffects(u.effects)}}},{key:"asyncManager",value:function(u,f){var s=this,o=f||{},v=o.loadingKey,g=v===void 0?"loading":v,E=o.errorKey,m=E===void 0?"error":E,U=o.showLoading,R=U===void 0?!0:U,V=o.config;this.asyncManagerMap[u]||(this.asyncManagerMap[u]=new N(V));var T=this.asyncManagerMap[u];return T.offAllListeners(),T.on("loading",function(){R&&s.setState(d()({},g,!0))}),T.on("success",function(t){A()(t)==="object"&&t!==null&&s.setState(M()(d()({},g,!1),t))}),T.on("error",function(t){s.setState(d()(d()({},g,!1),m,t))}),this.asyncManagerMap[u]}},{key:"subscribe",value:function(u){var f=this;return this._subscribes.push(u),function(){f.unsubscribe(u)}}},{key:"unsubscribe",value:function(u){this._subscribes.length&&(this._subscribes=this._subscribes.filter(function(f){return f!==u}))}},{key:"setState",value:function(u,f){this._isInited||this.init(),u&&(typeof u=="function"?this.state=this.getActualState(this._preState,u(this.state)):this.state=this.getActualState(this._preState,u),this.dispatch(f),this._preState=M()({},this.state))}},{key:"getActualState",value:function(u,f){var s=M()(M()({},u),f),o=this.config||{},v=o.watch,g=o.computed;return s=(0,P.calcComputedState)({prevState:u,nextState:s,computed:g}),(0,P.execWatchHandler)({prevState:u,nextState:s,watch:v}),s}},{key:"dispatch",value:function(u){var f=this;this.isUnMount||this._subscribes.forEach(function(s){return s(f,(u==null?void 0:u.silent)||!1)})}},{key:"setEffect",value:function(u,f){this._effects[u]!==f&&(this._effects[u]=typeof f=="function"?f.bind(this):f)}},{key:"setEffects",value:function(u){var f=this;Object.keys(u).forEach(function(s){f.setEffect(s,u[s])})}},{key:"getEffect",value:function(u){var f=this;return function(){for(var s=arguments.length,o=new Array(s),v=0;v<s;v++)o[v]=arguments[v];return f._effects[u].apply(f,o)}}},{key:"dispose",value:function(){this._effects={},this.state={}}},{key:"subscribeWithKeys",value:function(u,f){var s=this,o=f.keys,v=f.equalityFn;return this.subscribe(function(g,E){var m=s.getState();o&&(0,P.shallowEqualKeys)(s._preState,m,o)||v&&v(s._preState,m)||u(s,E)})}}]),O}();function W(O){var h=(0,D.useMemo)(function(){return new z(O)},[]);return h.config=O,O.effects&&h.setEffects(O.effects),(0,D.useEffect)(function(){return h.isUnMount=!1,function(){h.isUnMount=!0}},[h]),h}},15361:function(H,C,a){"use strict";a.r(C),a.d(C,{useCreation:function(){return M},useLatest:function(){return A},useMemoizedFn:function(){return b}});var p=a(75271);function A(y){var S=(0,p.useRef)(y);return S.current=y,S}function b(y){var S=(0,p.useRef)(y);return S.current=y,(0,p.useCallback)(function(){return S.current.apply(S,arguments)},[])}function M(y,S){var I=A(y);return(0,p.useMemo)(function(){return I.current()},S)}},49900:function(H,C,a){"use strict";a.r(C),a.d(C,{Model:function(){return p.H},useModel:function(){return p.t}});var p=a(66042),A=a(66454),b=a.n(A),M={};for(var y in A)["default","Model","useModel"].indexOf(y)<0&&(M[y]=function(S){return A[S]}.bind(0,y));a.d(C,M)},66454:function(){},80189:function(H,C,a){"use strict";a.r(C),a.d(C,{EventEmitter:function(){return V},EventEmitter2:function(){return T},arrayToMap:function(){return A},arrayToObj:function(){return p},calcComputedState:function(){return O},calcDiffKeys:function(){return W},diffObjectUpdate:function(){return G},execWatchHandler:function(){return h},filterObject:function(){return $},getFieldsValue:function(){return F},getObjValues:function(){return P},hasProps:function(){return Q},isDefined:function(){return L},isObject:function(){return N},isSameObject:function(){return D},isUndefined:function(){return I},makeObject:function(){return Y},objectToArray:function(){return X},omit:function(){return d},pick:function(){return B},setFiledsValue:function(){return J},shallowEqualKeys:function(){return Z},shortUUID:function(){return z},uuid:function(){return w}});function p(t,r,n){var i={},e=n||function(l){return l},c=r||function(l){return l};return t&&t.forEach(function(l){i[c(l)]=e(l)}),i}function A(t,r,n){var i=new Map,e=n||function(l){return l},c=r||function(l){return l};return t&&t.forEach(function(l){i.set(c(l),e(l))}),i}var b=a(31759),M=a.n(b),y=a(26068),S=a.n(y);function I(t){return t==null}function L(t){return!I(t)}function B(t,r){var n={};return t&&r.forEach(function(i){n[i]=t[i]}),n}function d(t,r){var n=S()({},t);return t&&(typeof r=="string"?delete n[r]:r.forEach(function(i){delete n[i]})),n}function D(t,r,n){if(!t||!r)return!1;var i=Object.keys(t),e=Object.keys(r);if(i.length!==e.length)return!1;for(var c=n||i,l=0;l<c.length;l++){var x=c[l],j=c[l];if(x!==j||t[x]!==r[j])return!1}return!0}function $(t,r){var n={},i=(r==null?void 0:r.filter)||[];return Object.keys(t).forEach(function(e){I(t[e])||i.includes(t[e])||(n[e]=t[e])}),n}function G(t,r,n,i){i?Object.keys(r).forEach(function(e){n(e,r[e],t[e])}):Object.keys(r).forEach(function(e){t[e]!==r[e]&&n(e,r[e],t[e])})}function F(t,r){var n=t;if(!n||!r)return n;if(typeof r=="string")return n[r];for(var i=0;i<r.length;i++){var e=r[i];if(n=n[e],!n)return n}return n}function J(t,r,n){if(t&&r){typeof r=="string"&&(t[r]=n);for(var i=t,e=0;e<r.length-1;e++)if(i=i[r[e]],!i)return;i[r[r.length-1]]=n}}function X(t,r){if(!t)return[];var n=r||function(e,c,l){return l},i=[];return Object.keys(t).forEach(function(e){i.push(n(t[e],e,t[e]))}),i}function Q(t,r){if(!t||!r||!r.length)return!1;for(var n=0,i=r.length;n<i;n++){var e=r[n];if(typeof e=="string"){if(Object.prototype.hasOwnProperty.call(t,e))return!0}else{if(e.length===1&&Object.prototype.hasOwnProperty.call(t,e[0]))return!0;if(e.length>1){var c=F(t,e.slice(-1));if(L(c)&&Object.prototype.hasOwnProperty.call(t,e[e.length-1]))return!0}}}return!1}function Z(t,r,n){return!t||!r?!1:M()(t)==="object"&&M()(r)==="object"?D(t,r,n):!1}function P(t,r){var n={};return r.forEach(function(i){var e=t[i];L(e)&&(n[i]=e)}),n}function Y(t,r){var n=t;if(t||(n={}),Array.isArray(r))for(var i=n,e=0;e<r.length-1;e++){var c=r[e];(!i[c]||M()(i[c])!=="object"&&!Array.isArray(i[c]))&&(i[c]={},i=i[c])}return n}function N(t){return t?Object.prototype.toString.call(t)==="[object Object]":!1}function K(){return((1+Math.random())*65536|0).toString(16).substring(1)}function w(){return K()+"-"+K()+"-"+K()+"-"+K()+"-"+K()}function z(){return K()+K()}function W(t,r,n){var i={},e=!1;return n.forEach(function(c){Object.is(t[c],r[c])||(i[c]=!0,e=!0)}),{diffKeysMap:i,diff:e}}function O(t){var r=t.prevState,n=t.nextState,i=t.computed;return i&&i.reduce(function(e,c){var l;if(typeof c=="function")l=c(e,r);else{var x=W(r,e,c.keys),j=x.diffKeysMap,k=x.diff;k&&(l=c.handler(e,r,j))}return l&&Object.assign(e,l),e},n),n}function h(t){var r=t.prevState,n=t.nextState,i=t.watch;i&&i.forEach(function(e){if(e.keys){var c=W(r,n,e.keys),l=c.diffKeysMap,x=c.diff;x&&e.handler&&e.handler(n,r,l)}})}var u=a(21742),f=a.n(u),s=a(83136),o=a.n(s),v=a(25298),g=a.n(v),E=a(17069),m=a.n(E),U=a(82092),R=a.n(U),V=function(){function t(){g()(this,t),R()(this,"_listeners",{})}return m()(t,[{key:"on",value:function(n,i){var e=this;return this._listeners[n]||(this._listeners[n]=[]),this._listeners[n].push(i),function(){e.off(n,i)}}},{key:"once",value:function(n,i){var e=this.on(n,function(){i.apply(void 0,arguments),e()})}},{key:"emit",value:function(n){for(var i=arguments.length,e=new Array(i>1?i-1:0),c=1;c<i;c++)e[c-1]=arguments[c];var l=this._listeners[n];return!l||!l.length?!1:(l.forEach(function(x){x.apply(void 0,e)}),!0)}},{key:"off",value:function(n,i){var e=this._listeners[n];if(!(!e||!e.length)){if(!i){this._listeners[n]=void 0;return}this._listeners[n]=e.filter(function(c){return c!==i})}}},{key:"offAllListeners",value:function(){this._listeners={}}}]),t}(),T=function(t){f()(n,t);var r=o()(n);function n(){return g()(this,n),r.apply(this,arguments)}return m()(n)}(V)}}]);
